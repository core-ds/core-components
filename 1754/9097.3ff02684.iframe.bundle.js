"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9097],{"./packages/gallery/src/Component.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{r:function(){return Gallery}});var defineProperty=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js"),slicedToArray=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),modern=__webpack_require__("./dist/base-modal/modern/index.js"),mq_modern=__webpack_require__("./dist/mq/modern/index.js"),button_modern=__webpack_require__("./dist/button/modern/index.js"),typography_modern=__webpack_require__("./dist/typography/modern/index.js"),mockFn=function(){},GalleryContext=(0,react.createContext)({view:"desktop",singleSlide:!1,currentSlideIndex:0,images:[],imagesMeta:[],fullScreen:!1,mutedVideo:!1,playingVideo:!1,hideNavigation:!1,setHideNavigation:mockFn,setMutedVideo:mockFn,setPlayingVideo:mockFn,initialSlide:0,setFullScreen:mockFn,setImageMeta:mockFn,slideTo:mockFn,slideNext:mockFn,slidePrev:mockFn,getSwiper:mockFn,setSwiper:mockFn,onClose:mockFn,setCurrentSlideIndex:mockFn,getCurrentImage:mockFn,getCurrentImageMeta:mockFn}),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),BottomButton=function(_ref){var onClick=_ref.onClick,className=_ref.className,bottomButton=_ref.bottomButton,timer=(0,react.useRef)(),_useState=(0,react.useState)(!1),_useState2=(0,slicedToArray.Z)(_useState,2),visible=_useState2[0],setVisible=_useState2[1],_useContext=(0,react.useContext)(GalleryContext),currentSlideIndex=_useContext.currentSlideIndex,getSwiper=_useContext.getSwiper,singleSlide=_useContext.singleSlide;return(0,react.useEffect)(function(){var swiper=getSwiper();(currentSlideIndex===(null==swiper?void 0:swiper.activeIndex)||singleSlide)&&bottomButton.timeout&&(timer.current&&clearTimeout(timer.current),setVisible(!1),timer.current=setTimeout(function(){return setVisible(!0)},1e3*bottomButton.timeout))},[bottomButton.timeout,currentSlideIndex,singleSlide]),(0,jsx_runtime.jsx)(button_modern.Button,{size:56,className:classnames_default()("component_ru3eE",(0,defineProperty.Z)({},"notVisible_fzHkj",!visible&&bottomButton.timeout),className),onClick:onClick,children:(0,jsx_runtime.jsx)(typography_modern.Typography.Text,{color:"static-primary-light",children:bottomButton.text})})};try{BottomButton.displayName="BottomButton",BottomButton.__docgenInfo={description:"",displayName:"BottomButton",props:{onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(e: MouseEvent<Element, MouseEvent>) => void"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},bottomButton:{defaultValue:null,description:"",name:"bottomButton",required:!0,type:{name:"TBottomButton"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/bottom-button/Component.tsx#BottomButton"]={docgenInfo:BottomButton.__docgenInfo,name:"BottomButton",path:"packages/gallery/src/components/bottom-button/Component.tsx#BottomButton"})}catch(__react_docgen_typescript_loader_error){}var getImageKey=function(_ref,index){var _ref$name=_ref.name,src=_ref.src;return"".concat(void 0===_ref$name?"":_ref$name,"-").concat(index,"-").concat(src)},getImageAlt=function(_ref2,index){var alt=_ref2.alt,name=_ref2.name;return alt||name||"Изображение ".concat(index+1)},isSmallImage=function(meta){return!!meta&&!!meta.width&&!!meta.height&&meta.width<400&&meta.height<300},isVideo=function(url){return[".webm",".mp4",".m3u8"].some(function(item){return null==url?void 0:url.endsWith(item)})},element_closest=__webpack_require__("./node_modules/element-closest/index.mjs"),image_viewer_index_module={component:"component_dvqF7",swiper:"swiper_l0Uv5",mobile:"mobile_YcT7N",mobileVideo:"mobileVideo_OXREw",singleSlideContainer:"singleSlideContainer_cZad0",hidden:"hidden_RuunA",slide:"slide_O6qSV",slideLoading:"slideLoading_z7dpT",spinner:"spinner_zcX9_",image:"image_vBBzW",smallImage:"smallImage_OYzsj",verticalImageFit:"verticalImageFit_vgKcS",horizontalImageFit:"horizontalImageFit_xDygz",arrow:"arrow_dDnVx",focused:"focused_YALHx",placeholder:"placeholder_xyf_j",brokenImgWrapper:"brokenImgWrapper_AKvv4",brokenImgIcon:"brokenImgIcon_MdTbJ",fullScreenImage:"fullScreenImage_eN1ip",fullScreenVideo:"fullScreenVideo_eorgH"},useHandleImageViewer=function(){var _useContext=(0,react.useContext)(GalleryContext),view=_useContext.view,onClose=_useContext.onClose,setImageMeta=_useContext.setImageMeta,leftArrowRef=(0,react.useRef)(null),rightArrowRef=(0,react.useRef)(null),isMobile="mobile"===view,handleWrapperClick=(0,react.useCallback)(function(event){var _leftArrowRef$current,_rightArrowRef$curren,eventTarget=event.target,isArrow=(null===(_leftArrowRef$current=leftArrowRef.current)||void 0===_leftArrowRef$current?void 0:_leftArrowRef$current.contains(eventTarget))||(null===(_rightArrowRef$curren=rightArrowRef.current)||void 0===_rightArrowRef$curren?void 0:_rightArrowRef$curren.contains(eventTarget)),isPlaceholder=!!eventTarget.closest(".".concat(image_viewer_index_module.placeholder));"IMG"===eventTarget.tagName||isPlaceholder||isArrow||isMobile||onClose()},[isMobile,onClose]);return(0,react.useEffect)(function(){(0,element_closest.Z)(window)},[]),{handleLoad:function(event,index){var target=event.currentTarget;setImageMeta({width:target.naturalWidth,height:target.naturalHeight},index)},handleLoadError:function(index){setImageMeta({width:0,height:0,broken:!0},index)},handleWrapperClick:handleWrapperClick,isMobile:isMobile,leftArrowRef:leftArrowRef,rightArrowRef:rightArrowRef}},spinner_modern=__webpack_require__("./dist/spinner/modern/index.js"),constants=__webpack_require__("./packages/gallery/src/utils/constants.ts"),NoImagePaths={baseImage:"M61 13H8C5.79086 13 4 14.7908 4 17V63C4 65.2092 5.79086 67 8 67H72C74.2091 67 76 65.2092 76 63V27.9998H64.7333C62.6714 27.9998 61 26.3284 61 24.2665V13ZM23.8337 31.3334C24.57 30.597 25.7639 30.597 26.5003 31.3334L28.5001 33.3332L30.4999 31.3333C31.2363 30.5969 32.4302 30.5969 33.1666 31.3333C33.903 32.0697 33.903 33.2636 33.1666 34L31.1667 35.9998L33.1669 38C33.9033 38.7363 33.9033 39.9302 33.1669 40.6666C32.4306 41.403 31.2367 41.403 30.5003 40.6666L28.5001 38.6664L26.5 40.6666C25.7636 41.403 24.5697 41.403 23.8333 40.6666C23.097 39.9302 23.097 38.7363 23.8333 37.9999L25.8335 35.9998L23.8337 34C23.0973 33.2636 23.0973 32.0697 23.8337 31.3334ZM49.4984 31.3334C48.762 30.597 47.5681 30.597 46.8317 31.3334C46.0953 32.0698 46.0953 33.2637 46.8317 34L48.8315 35.9998L46.8314 38C46.095 38.7363 46.095 39.9302 46.8314 40.6666C47.5677 41.403 48.7617 41.403 49.498 40.6666L51.4982 38.6664L53.4984 40.6666C54.2347 41.403 55.4286 41.403 56.165 40.6666C56.9014 39.9303 56.9014 38.7364 56.165 38L54.1648 35.9998L56.1646 34C56.901 33.2636 56.901 32.0697 56.1646 31.3334C55.4283 30.597 54.2344 30.597 53.498 31.3334L51.4982 33.3332L49.4984 31.3334ZM28.8087 55.8292L28.8076 55.8297C27.7997 56.2743 26.6202 55.8199 26.1724 54.8123C25.7238 53.8029 26.1783 52.621 27.1877 52.1724L28 54C27.1877 52.1724 27.1889 52.1719 27.1889 52.1719L27.1902 52.1713L27.193 52.17L27.1999 52.167L27.2187 52.1588L27.2425 52.1486L27.2762 52.1343C27.3234 52.1144 27.388 52.0878 27.4698 52.0553C27.6333 51.9904 27.8654 51.9021 28.1633 51.7985C28.7588 51.5914 29.6177 51.3226 30.7163 51.0563C32.9132 50.5237 36.072 50 40 50C43.928 50 47.0868 50.5237 49.2837 51.0563C50.3823 51.3226 51.2412 51.5914 51.8367 51.7985C51.9387 51.834 52.033 51.8677 52.1195 51.8992C52.2855 51.9598 52.4227 52.0126 52.5302 52.0553C52.5704 52.0713 52.6065 52.0858 52.6384 52.0989C52.6713 52.1124 52.6998 52.1242 52.7238 52.1343L52.7677 52.1529L52.7813 52.1588L52.8001 52.167L52.807 52.17L52.8099 52.1713L52.8111 52.1719C52.8111 52.1719 52.8112 52.1719 52.8075 52.1806L52.7938 52.2121L52.8123 52.1724C53.8217 52.621 54.2762 53.8029 53.8276 54.8123C53.3798 55.8199 52.2013 56.2746 51.1931 55.83L51.1913 55.8292L40.8962 55.8291L51.1899 55.8286L51.1715 55.8208C51.149 55.8113 51.1097 55.795 51.0538 55.7728C50.9419 55.7284 50.7639 55.6604 50.5226 55.5765C50.0401 55.4086 49.3052 55.1774 48.3413 54.9437C46.4132 54.4763 43.572 54 40 54C36.428 54 33.5868 54.4763 31.6587 54.9437C30.6948 55.1774 29.9599 55.4086 29.4774 55.5765C29.2361 55.6604 29.0581 55.7284 28.9462 55.7728C28.8903 55.795 28.851 55.8113 28.8285 55.8208L28.8112 55.8281L40.8962 55.8291L28.8087 55.8292Z",triangleImage:"M75.9998 23.9998H65V13L75.9998 23.9998Z"},dist_hls=__webpack_require__("./node_modules/hls.js/dist/hls.mjs"),circle=__webpack_require__("./dist/icon-view/modern/circle/index.js"),PlayCompactMIcon=__webpack_require__("./node_modules/@alfalab/icons-glyph/PlayCompactMIcon.js"),toConsumableArray=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),useCustomSubtitles=function(){var _meta$player,meta=(0,(0,react.useContext)(GalleryContext).getCurrentImageMeta)(),_useState=(0,react.useState)(!1),_useState2=(0,slicedToArray.Z)(_useState,2),showSub=_useState2[0],setShowSub=_useState2[1],_useState3=(0,react.useState)(""),_useState4=(0,slicedToArray.Z)(_useState3,2),currentSub=_useState4[0],setCurrentSub=_useState4[1],player=null==meta?void 0:null===(_meta$player=meta.player)||void 0===_meta$player?void 0:_meta$player.current;return(0,react.useEffect)(function(){var intervalId=setInterval(function(){if(player){var _textTrack$activeCues,textTrack=(0,toConsumableArray.Z)(Array.from(player.textTracks)||[]).find(function(track){return"subtitles"===track.kind}),activeCue=null==textTrack?void 0:null===(_textTrack$activeCues=textTrack.activeCues)||void 0===_textTrack$activeCues?void 0:_textTrack$activeCues[0];if(!(null!=activeCue&&activeCue.text)){setShowSub(!1);return}var isVisible=(null==player?void 0:player.currentTime)>=activeCue.startTime&&(null==player?void 0:player.currentTime)<=activeCue.endTime-.5;setCurrentSub(activeCue.text),setShowSub(isVisible)}});return function(){clearInterval(intervalId)}},[player]),{showSub:showSub,currentSub:currentSub}},subtitles_index_module={subtitles:"subtitles_RSNb1",mobile:"mobile_bBMzn",hideSubtitles:"hideSubtitles_mr1tP"},Subtitles=function(){var view=(0,react.useContext)(GalleryContext).view,_useCustomSubtitles=useCustomSubtitles(),showSub=_useCustomSubtitles.showSub,currentSub=_useCustomSubtitles.currentSub;return showSub?(0,jsx_runtime.jsx)(typography_modern.Typography.Text,{className:classnames_default()(subtitles_index_module.subtitles,(0,defineProperty.Z)((0,defineProperty.Z)({},subtitles_index_module.hideSubtitles,!showSub),subtitles_index_module.mobile,"mobile"===view)),color:"static-primary-light",children:currentSub}):null},video_index_module={videoWrapper:"videoWrapper_X0xUs",video:"video_K5X1E",mobile:"mobile_HSv8d",videoButton:"videoButton_XdfHZ",icon:"icon_ZbIp_",iconShape:"iconShape_fcf0U",bottomButton:"bottomButton_fFulc"},Video=function(_ref){var url=_ref.url,index=_ref.index,className=_ref.className,isActive=_ref.isActive,playerRef=(0,react.useRef)(null),timer=(0,react.useRef)(),_useContext=(0,react.useContext)(GalleryContext),setImageMeta=_useContext.setImageMeta,mutedVideo=_useContext.mutedVideo,view=_useContext.view,playingVideo=_useContext.playingVideo,setPlayingVideo=_useContext.setPlayingVideo,setHideNavigation=_useContext.setHideNavigation,getCurrentImage=_useContext.getCurrentImage,isMobile="mobile"===view,isDesktop="desktop"===view,image=getCurrentImage();(0,react.useEffect)(function(){setImageMeta({player:playerRef},index)},[index]),(0,react.useEffect)(function(){var hls=new dist_hls.ZP;return dist_hls.ZP.isSupported()&&(hls.on(dist_hls.ZP.Events.ERROR,function(_,data){if(data.fatal)switch(data.type){case dist_hls.ZP.ErrorTypes.MEDIA_ERROR:hls.recoverMediaError();break;case dist_hls.ZP.ErrorTypes.NETWORK_ERROR:setImageMeta({player:{current:null},broken:!0},index);break;default:hls.destroy()}}),hls.loadSource(url),playerRef.current&&(hls.attachMedia(playerRef.current),hls.subtitleDisplay=!1)),function(){hls&&hls.destroy(),timer.current&&clearTimeout(timer.current)}},[url,index]),(0,react.useEffect)(function(){playerRef.current&&isActive&&(playingVideo?playerRef.current.play():playerRef.current.pause()),playerRef.current&&!isActive&&(playerRef.current.pause(),playerRef.current.currentTime=0)},[isActive,playingVideo]),(0,react.useEffect)(function(){var handleSpacePress=function(e){(" "===e.key||"Space"===e.code)&&isActive&&(playingVideo?setPlayingVideo(!1):setPlayingVideo(!0))};return document.addEventListener("keyup",handleSpacePress),function(){document.removeEventListener("keyup",handleSpacePress)}},[isActive,playingVideo,setPlayingVideo]);var handleBottomButtonClick=(0,react.useCallback)(function(e){e.stopPropagation(),null!=image&&image.bottomButton&&image.bottomButton.onClick(e)},[null==image?void 0:image.bottomButton]);return(0,jsx_runtime.jsxs)("div",{onClick:function(e){if(e.stopPropagation(),isMobile){setHideNavigation(!1),playingVideo&&(timer.current&&clearTimeout(timer.current),timer.current=setTimeout(function(){setHideNavigation(!0)},3e3));return}setPlayingVideo(!playingVideo)},className:video_index_module.videoWrapper,children:[(0,jsx_runtime.jsx)("video",{onPlay:function(){image&&image.onPlay&&image.onPlay(),timer.current&&clearTimeout(timer.current),timer.current=setTimeout(function(){setHideNavigation(!0)},3e3)},onPause:function(){image&&image.onPause&&image.onPause(),timer.current&&(clearTimeout(timer.current),timer.current=void 0),setHideNavigation(!1)},ref:playerRef,playsInline:!0,muted:mutedVideo,loop:!0,src:dist_hls.ZP.isSupported()?void 0:url,className:classnames_default()(video_index_module.video,(0,defineProperty.Z)({},video_index_module.mobile,"mobile"===view),className),children:(0,jsx_runtime.jsx)("track",{kind:"captions"})}),isDesktop&&!playingVideo&&(0,jsx_runtime.jsx)("div",{className:video_index_module.videoButton,children:(0,jsx_runtime.jsx)(circle.Circle,{size:64,shapeClassName:video_index_module.iconShape,children:(0,jsx_runtime.jsx)(PlayCompactMIcon.default,{className:video_index_module.icon})})}),isDesktop&&(0,jsx_runtime.jsx)(Subtitles,{}),isDesktop&&(null==image?void 0:image.bottomButton)&&(0,jsx_runtime.jsx)(BottomButton,{bottomButton:image.bottomButton,onClick:handleBottomButtonClick,className:video_index_module.bottomButton})]})};try{Video.displayName="Video",Video.__docgenInfo={description:"",displayName:"Video",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},isActive:{defaultValue:null,description:"",name:"isActive",required:!0,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/image-viewer/video/index.tsx#Video"]={docgenInfo:Video.__docgenInfo,name:"Video",path:"packages/gallery/src/components/image-viewer/video/index.tsx#Video"})}catch(__react_docgen_typescript_loader_error){}var SlideInner=function(_ref){var children=_ref.children,broken=_ref.broken,loading=_ref.loading,isVideoView=_ref.isVideoView,content=broken?(0,jsx_runtime.jsxs)("div",{className:image_viewer_index_module.brokenImgWrapper,children:[(0,jsx_runtime.jsx)("div",{className:image_viewer_index_module.brokenImgIcon,children:(0,jsx_runtime.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"80",height:"80",viewBox:"0 0 80 80",fill:"none",children:[(0,jsx_runtime.jsx)("rect",{width:"80",height:"80",fill:"none"}),(0,jsx_runtime.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:NoImagePaths.baseImage,fill:"#89898A"}),(0,jsx_runtime.jsx)("path",{d:NoImagePaths.triangleImage,fill:"#89898A"})]})}),(0,jsx_runtime.jsxs)(typography_modern.Text,{view:"primary-small",color:"static-secondary-light",children:["Не удалось загрузить ",isVideoView?"видео":"изображение"]})]}):children;return(0,jsx_runtime.jsxs)("div",{className:classnames_default()(image_viewer_index_module.slide,(0,defineProperty.Z)({},image_viewer_index_module.slideLoading,loading)),children:[broken?(0,jsx_runtime.jsx)("div",{className:image_viewer_index_module.placeholder,children:content}):content,(0,jsx_runtime.jsx)(spinner_modern.Spinner,{className:image_viewer_index_module.spinner,preset:48,visible:loading})]})},Slide=function(_ref2){var isActive=_ref2.isActive,meta=_ref2.meta,containerAspectRatio=_ref2.containerAspectRatio,imageAspectRatio=_ref2.imageAspectRatio,image=_ref2.image,index=_ref2.index,containerHeight=_ref2.containerHeight,slideVisible=_ref2.slideVisible,view=(0,react.useContext)(GalleryContext).view,_useHandleImageViewer=useHandleImageViewer(),handleLoad=_useHandleImageViewer.handleLoad,handleLoadError=_useHandleImageViewer.handleLoadError,broken=!!(null==meta?void 0:meta.broken),small=isSmallImage(meta);return isVideo(image.src)?(0,jsx_runtime.jsx)(SlideInner,{isVideoView:!0,active:isActive,broken:broken,loading:!meta,children:(0,jsx_runtime.jsx)(Video,{url:image.src,index:index,isActive:isActive})}):(0,jsx_runtime.jsx)(SlideInner,{active:isActive,broken:broken,loading:!meta,children:(0,jsx_runtime.jsx)("img",{src:image.src,alt:getImageAlt(image,index),className:classnames_default()((0,defineProperty.Z)((0,defineProperty.Z)((0,defineProperty.Z)((0,defineProperty.Z)((0,defineProperty.Z)({},image_viewer_index_module.smallImage,small),image_viewer_index_module.image,!small&&meta),image_viewer_index_module.mobile,"mobile"===view),image_viewer_index_module.verticalImageFit,!small&&containerAspectRatio>imageAspectRatio),image_viewer_index_module.horizontalImageFit,!small&&containerAspectRatio<=imageAspectRatio)),onLoad:function onLoad(event){return handleLoad(event,index)},onError:function onError(){return handleLoadError(index)},style:{maxHeight:"".concat(containerHeight,"px")},"data-test-id":slideVisible?constants.D.ACTIVE_IMAGE:void 0})})};try{Slide.displayName="Slide",Slide.__docgenInfo={description:"",displayName:"Slide",props:{isActive:{defaultValue:null,description:"",name:"isActive",required:!0,type:{name:"boolean"}},image:{defaultValue:null,description:"",name:"image",required:!0,type:{name:"GalleryImage"}},meta:{defaultValue:null,description:"",name:"meta",required:!1,type:{name:"ImageMeta"}},containerAspectRatio:{defaultValue:null,description:"",name:"containerAspectRatio",required:!0,type:{name:"number"}},imageAspectRatio:{defaultValue:null,description:"",name:"imageAspectRatio",required:!0,type:{name:"number"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},containerHeight:{defaultValue:null,description:"",name:"containerHeight",required:!0,type:{name:"number"}},slideVisible:{defaultValue:null,description:"",name:"slideVisible",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/image-viewer/slide.tsx#Slide"]={docgenInfo:Slide.__docgenInfo,name:"Slide",path:"packages/gallery/src/components/image-viewer/slide.tsx#Slide"})}catch(__react_docgen_typescript_loader_error){}var Single=function(){var _wrapperRef$current,_useContext=(0,react.useContext)(GalleryContext),fullScreen=_useContext.fullScreen,currentSlideIndex=_useContext.currentSlideIndex,getCurrentImage=_useContext.getCurrentImage,getCurrentImageMeta=_useContext.getCurrentImageMeta,_useHandleImageViewer=useHandleImageViewer(),handleWrapperClick=_useHandleImageViewer.handleWrapperClick,isMobile=_useHandleImageViewer.isMobile,wrapperRef=(0,react.useRef)(null),currentImage=getCurrentImage(),currentImageMeta=getCurrentImageMeta();if(!currentImage)return null;var imageWidth=(null==currentImageMeta?void 0:currentImageMeta.width)||1,imageHeight=(null==currentImageMeta?void 0:currentImageMeta.height)||1,wrapperRect=null===(_wrapperRef$current=wrapperRef.current)||void 0===_wrapperRef$current?void 0:_wrapperRef$current.getBoundingClientRect(),wrapperAspectRatio=((null==wrapperRect?void 0:wrapperRect.width)||1)/((null==wrapperRect?void 0:wrapperRect.height)||1);return(0,jsx_runtime.jsx)("div",{className:image_viewer_index_module.component,onClick:handleWrapperClick,children:fullScreen&&!isVideo(null==currentImage?void 0:currentImage.src)?(0,jsx_runtime.jsx)("img",{src:null==currentImage?void 0:currentImage.src,alt:currentImage?getImageAlt(currentImage,currentSlideIndex):"",className:image_viewer_index_module.fullScreenImage}):(0,jsx_runtime.jsx)("div",{className:classnames_default()(image_viewer_index_module.singleSlideContainer,(0,defineProperty.Z)((0,defineProperty.Z)({},image_viewer_index_module.mobile,isMobile),image_viewer_index_module.mobileVideo,isMobile&&isVideo(null==currentImage?void 0:currentImage.src))),ref:wrapperRef,children:(0,jsx_runtime.jsx)(Slide,{isActive:!0,containerAspectRatio:wrapperAspectRatio,image:currentImage,containerHeight:(null==wrapperRect?void 0:wrapperRect.height)||0,meta:currentImageMeta,index:currentSlideIndex,imageAspectRatio:imageWidth/imageHeight,slideVisible:!0})})})};try{Single.displayName="Single",Single.__docgenInfo={description:"",displayName:"Single",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/image-viewer/single.tsx#Single"]={docgenInfo:Single.__docgenInfo,name:"Single",path:"packages/gallery/src/components/image-viewer/single.tsx#Single"})}catch(__react_docgen_typescript_loader_error){}var objectSpread2=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),objectWithoutProperties=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),icon_button_modern=__webpack_require__("./dist/icon-button/modern/index.js"),desktop=__webpack_require__("./dist/tooltip/modern/desktop/index.js"),ArrowLeftMIcon=__webpack_require__("./node_modules/@alfalab/icons-glyph/ArrowLeftMIcon.js"),ArrowsInwardMIcon=__webpack_require__("./node_modules/@alfalab/icons-glyph/ArrowsInwardMIcon.js"),ArrowsOutwardMIcon=__webpack_require__("./node_modules/@alfalab/icons-glyph/ArrowsOutwardMIcon.js"),CrossMIcon=__webpack_require__("./node_modules/@alfalab/icons-glyph/CrossMIcon.js"),PauseCompactMIcon=__webpack_require__("./node_modules/@alfalab/icons-glyph/PauseCompactMIcon.js"),PointerDownMIcon=__webpack_require__("./node_modules/@alfalab/icons-glyph/PointerDownMIcon.js"),ShareMIcon=__webpack_require__("./node_modules/@alfalab/icons-glyph/ShareMIcon.js"),SoundCrossMIcon=__webpack_require__("./node_modules/@alfalab/icons-glyph/SoundCrossMIcon.js"),SoundMIcon=__webpack_require__("./node_modules/@alfalab/icons-glyph/SoundMIcon.js"),buttons_index_module={iconButton:"iconButton_p14ub"},_excluded=["buttonRef"],_excluded2=["buttonRef"],_excluded3=["buttonRef","className"],_excluded4=["buttonRef","className"],_excluded5=["buttonRef"],_excluded6=["buttonRef","className"],_excluded7=["buttonRef","className"],Fullscreen=function(_ref){var buttonRef=_ref.buttonRef,restProps=(0,objectWithoutProperties.Z)(_ref,_excluded);return(0,jsx_runtime.jsx)(desktop.TooltipDesktop,{trigger:"hover",position:"bottom",content:"Открыть в полноэкранном режиме",fallbackPlacements:["bottom-end"],children:(0,jsx_runtime.jsx)(icon_button_modern.IconButton,(0,objectSpread2.Z)((0,objectSpread2.Z)({},restProps),{},{ref:buttonRef,icon:ArrowsOutwardMIcon.ArrowsOutwardMIcon,"aria-label":"Открыть в полноэкранном режиме",className:buttons_index_module.iconButton}))})},BackArrow=function(_ref2){var buttonRef=_ref2.buttonRef,restProps=(0,objectWithoutProperties.Z)(_ref2,_excluded2);return(0,jsx_runtime.jsx)(icon_button_modern.IconButton,(0,objectSpread2.Z)((0,objectSpread2.Z)({},restProps),{},{ref:buttonRef,icon:ArrowLeftMIcon.ArrowLeftMIcon,"aria-label":"Вернуться назад",className:buttons_index_module.iconButton}))},Play=function(_ref3){var buttonRef=_ref3.buttonRef,className=_ref3.className,restProps=(0,objectWithoutProperties.Z)(_ref3,_excluded3);return(0,jsx_runtime.jsx)(icon_button_modern.IconButton,(0,objectSpread2.Z)((0,objectSpread2.Z)({},restProps),{},{ref:buttonRef,icon:PlayCompactMIcon.PlayCompactMIcon,"aria-label":"Проиграть видео",className:classnames_default()(buttons_index_module.iconButton,className)}))},Pause=function(_ref4){var buttonRef=_ref4.buttonRef,className=_ref4.className,restProps=(0,objectWithoutProperties.Z)(_ref4,_excluded4);return(0,jsx_runtime.jsx)(icon_button_modern.IconButton,(0,objectSpread2.Z)((0,objectSpread2.Z)({},restProps),{},{ref:buttonRef,icon:PauseCompactMIcon.PauseCompactMIcon,"aria-label":"Поставить паузу на видео",className:classnames_default()(buttons_index_module.iconButton,className)}))},ExitFullscreen=function(_ref5){var buttonRef=_ref5.buttonRef,restProps=(0,objectWithoutProperties.Z)(_ref5,_excluded5);return(0,jsx_runtime.jsx)(desktop.TooltipDesktop,{trigger:"hover",position:"bottom",content:"Выйти из полноэкранного режима",fallbackPlacements:["bottom-end"],children:(0,jsx_runtime.jsx)(icon_button_modern.IconButton,(0,objectSpread2.Z)((0,objectSpread2.Z)({},restProps),{},{ref:buttonRef,icon:ArrowsInwardMIcon.ArrowsInwardMIcon,"aria-label":"Выйти из полноэкранного режима",className:buttons_index_module.iconButton}))})},MuteVideo=function(_ref6){var buttonRef=_ref6.buttonRef,className=_ref6.className,restProps=(0,objectWithoutProperties.Z)(_ref6,_excluded6);return(0,jsx_runtime.jsx)(desktop.TooltipDesktop,{trigger:"hover",position:"bottom",content:"Выключить звук",fallbackPlacements:["bottom-end"],targetClassName:className,children:(0,jsx_runtime.jsx)(icon_button_modern.IconButton,(0,objectSpread2.Z)((0,objectSpread2.Z)({},restProps),{},{ref:buttonRef,icon:SoundMIcon.SoundMIcon,"aria-label":"Выключить звук",className:buttons_index_module.iconButton}))})},UnmuteVideo=function(_ref7){var buttonRef=_ref7.buttonRef,className=_ref7.className,restProps=(0,objectWithoutProperties.Z)(_ref7,_excluded7);return(0,jsx_runtime.jsx)(desktop.TooltipDesktop,{trigger:"hover",position:"bottom",content:"Включить звук",fallbackPlacements:["bottom-end"],targetClassName:className,children:(0,jsx_runtime.jsx)(icon_button_modern.IconButton,(0,objectSpread2.Z)((0,objectSpread2.Z)({},restProps),{},{ref:buttonRef,icon:SoundCrossMIcon.SoundCrossMIcon,"aria-label":"Включить звук",className:buttons_index_module.iconButton}))})},Download=function(props){return(0,jsx_runtime.jsx)(desktop.TooltipDesktop,{trigger:"hover",position:"bottom",content:"Скачать",fallbackPlacements:["bottom-end"],children:(0,jsx_runtime.jsx)(icon_button_modern.IconButton,(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{icon:PointerDownMIcon.PointerDownMIcon,"aria-label":"Скачать",className:buttons_index_module.iconButton}))})},Share=function(props){return(0,jsx_runtime.jsx)(desktop.TooltipDesktop,{trigger:"hover",position:"bottom",content:"Поделиться",fallbackPlacements:["bottom-end"],children:(0,jsx_runtime.jsx)(icon_button_modern.IconButton,(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{icon:ShareMIcon.ShareMIcon,"aria-label":"Скачать",className:buttons_index_module.iconButton}))})},Exit=function(props){return(0,jsx_runtime.jsx)(icon_button_modern.IconButton,(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{icon:CrossMIcon.CrossMIcon,"aria-label":"Закрыть",className:buttons_index_module.iconButton}))};try{Fullscreen.displayName="Fullscreen",Fullscreen.__docgenInfo={description:"",displayName:"Fullscreen",props:{buttonRef:{defaultValue:null,description:"",name:"buttonRef",required:!1,type:{name:"MutableRefObject<HTMLButtonElement | null>"}},download:{defaultValue:null,description:"",name:"download",required:!1,type:{name:"string | boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/buttons/index.tsx#Fullscreen"]={docgenInfo:Fullscreen.__docgenInfo,name:"Fullscreen",path:"packages/gallery/src/components/buttons/index.tsx#Fullscreen"})}catch(__react_docgen_typescript_loader_error){}try{BackArrow.displayName="BackArrow",BackArrow.__docgenInfo={description:"",displayName:"BackArrow",props:{buttonRef:{defaultValue:null,description:"",name:"buttonRef",required:!1,type:{name:"MutableRefObject<HTMLButtonElement | null>"}},download:{defaultValue:null,description:"",name:"download",required:!1,type:{name:"string | boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/buttons/index.tsx#BackArrow"]={docgenInfo:BackArrow.__docgenInfo,name:"BackArrow",path:"packages/gallery/src/components/buttons/index.tsx#BackArrow"})}catch(__react_docgen_typescript_loader_error){}try{Play.displayName="Play",Play.__docgenInfo={description:"",displayName:"Play",props:{buttonRef:{defaultValue:null,description:"",name:"buttonRef",required:!1,type:{name:"MutableRefObject<HTMLButtonElement | null>"}},download:{defaultValue:null,description:"",name:"download",required:!1,type:{name:"string | boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/buttons/index.tsx#Play"]={docgenInfo:Play.__docgenInfo,name:"Play",path:"packages/gallery/src/components/buttons/index.tsx#Play"})}catch(__react_docgen_typescript_loader_error){}try{Pause.displayName="Pause",Pause.__docgenInfo={description:"",displayName:"Pause",props:{buttonRef:{defaultValue:null,description:"",name:"buttonRef",required:!1,type:{name:"MutableRefObject<HTMLButtonElement | null>"}},download:{defaultValue:null,description:"",name:"download",required:!1,type:{name:"string | boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/buttons/index.tsx#Pause"]={docgenInfo:Pause.__docgenInfo,name:"Pause",path:"packages/gallery/src/components/buttons/index.tsx#Pause"})}catch(__react_docgen_typescript_loader_error){}try{ExitFullscreen.displayName="ExitFullscreen",ExitFullscreen.__docgenInfo={description:"",displayName:"ExitFullscreen",props:{buttonRef:{defaultValue:null,description:"",name:"buttonRef",required:!1,type:{name:"MutableRefObject<HTMLButtonElement | null>"}},download:{defaultValue:null,description:"",name:"download",required:!1,type:{name:"string | boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/buttons/index.tsx#ExitFullscreen"]={docgenInfo:ExitFullscreen.__docgenInfo,name:"ExitFullscreen",path:"packages/gallery/src/components/buttons/index.tsx#ExitFullscreen"})}catch(__react_docgen_typescript_loader_error){}try{MuteVideo.displayName="MuteVideo",MuteVideo.__docgenInfo={description:"",displayName:"MuteVideo",props:{buttonRef:{defaultValue:null,description:"",name:"buttonRef",required:!1,type:{name:"MutableRefObject<HTMLButtonElement | null>"}},download:{defaultValue:null,description:"",name:"download",required:!1,type:{name:"string | boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/buttons/index.tsx#MuteVideo"]={docgenInfo:MuteVideo.__docgenInfo,name:"MuteVideo",path:"packages/gallery/src/components/buttons/index.tsx#MuteVideo"})}catch(__react_docgen_typescript_loader_error){}try{UnmuteVideo.displayName="UnmuteVideo",UnmuteVideo.__docgenInfo={description:"",displayName:"UnmuteVideo",props:{buttonRef:{defaultValue:null,description:"",name:"buttonRef",required:!1,type:{name:"MutableRefObject<HTMLButtonElement | null>"}},download:{defaultValue:null,description:"",name:"download",required:!1,type:{name:"string | boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/buttons/index.tsx#UnmuteVideo"]={docgenInfo:UnmuteVideo.__docgenInfo,name:"UnmuteVideo",path:"packages/gallery/src/components/buttons/index.tsx#UnmuteVideo"})}catch(__react_docgen_typescript_loader_error){}try{Download.displayName="Download",Download.__docgenInfo={description:"",displayName:"Download",props:{buttonRef:{defaultValue:null,description:"",name:"buttonRef",required:!1,type:{name:"MutableRefObject<HTMLButtonElement | null>"}},download:{defaultValue:null,description:"",name:"download",required:!1,type:{name:"string | boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/buttons/index.tsx#Download"]={docgenInfo:Download.__docgenInfo,name:"Download",path:"packages/gallery/src/components/buttons/index.tsx#Download"})}catch(__react_docgen_typescript_loader_error){}try{Share.displayName="Share",Share.__docgenInfo={description:"",displayName:"Share",props:{buttonRef:{defaultValue:null,description:"",name:"buttonRef",required:!1,type:{name:"MutableRefObject<HTMLButtonElement | null>"}},download:{defaultValue:null,description:"",name:"download",required:!1,type:{name:"string | boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/buttons/index.tsx#Share"]={docgenInfo:Share.__docgenInfo,name:"Share",path:"packages/gallery/src/components/buttons/index.tsx#Share"})}catch(__react_docgen_typescript_loader_error){}try{Exit.displayName="Exit",Exit.__docgenInfo={description:"",displayName:"Exit",props:{buttonRef:{defaultValue:null,description:"",name:"buttonRef",required:!1,type:{name:"MutableRefObject<HTMLButtonElement | null>"}},download:{defaultValue:null,description:"",name:"download",required:!1,type:{name:"string | boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/buttons/index.tsx#Exit"]={docgenInfo:Exit.__docgenInfo,name:"Exit",path:"packages/gallery/src/components/buttons/index.tsx#Exit"})}catch(__react_docgen_typescript_loader_error){}function splitFilename(filename){var dotPosition=filename.lastIndexOf("."),head=filename,tail="",splitPosition=dotPosition-3;return splitPosition>0&&(head=filename.slice(0,splitPosition),tail=filename.slice(splitPosition)),[head,tail]}var header_info_block_index_module={info:"info_uzKIX",filenameHead:"filenameHead_ZGMUh",filenameContainer:"filenameContainer_j5oEY",description:"description_LkFxY"},HeaderInfoBlock=function(_ref){var filename=_ref.filename,description=_ref.description,_splitFilename=splitFilename(filename),_splitFilename2=(0,slicedToArray.Z)(_splitFilename,2),head=_splitFilename2[0],tail=_splitFilename2[1];return(0,jsx_runtime.jsxs)("div",{className:header_info_block_index_module.info,children:[(0,jsx_runtime.jsxs)("div",{className:header_info_block_index_module.filenameContainer,children:[(0,jsx_runtime.jsx)(typography_modern.TitleDesktop,{tag:"h1",className:header_info_block_index_module.filenameHead,view:"xsmall",font:"system",color:"static-primary-light",children:head}),(0,jsx_runtime.jsx)(typography_modern.TitleDesktop,{tag:"h1",view:"xsmall",font:"system",color:"static-primary-light",children:tail})]}),description?(0,jsx_runtime.jsx)(typography_modern.Text,{className:header_info_block_index_module.description,tag:"div",view:"primary-medium",color:"static-secondary-light",children:description}):null]})};try{HeaderInfoBlock.displayName="HeaderInfoBlock",HeaderInfoBlock.__docgenInfo={description:"",displayName:"HeaderInfoBlock",props:{filename:{defaultValue:null,description:"",name:"filename",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/header-info-block/Component.tsx#HeaderInfoBlock"]={docgenInfo:HeaderInfoBlock.__docgenInfo,name:"HeaderInfoBlock",path:"packages/gallery/src/components/header-info-block/Component.tsx#HeaderInfoBlock"})}catch(__react_docgen_typescript_loader_error){}var header_index_module={header:"header_toq_x"},Header=function(){var _currentImage$canDown,_useContext=(0,react.useContext)(GalleryContext),currentSlideIndex=_useContext.currentSlideIndex,singleSlide=_useContext.singleSlide,images=_useContext.images,fullScreen=_useContext.fullScreen,getCurrentImageMeta=_useContext.getCurrentImageMeta,getCurrentImage=_useContext.getCurrentImage,setFullScreen=_useContext.setFullScreen,onClose=_useContext.onClose,mutedVideo=_useContext.mutedVideo,setMutedVideo=_useContext.setMutedVideo,currentImage=getCurrentImage(),meta=getCurrentImageMeta(),toggleFullScreenButton=(0,react.useRef)(null),onMuteButtonClick=function(){currentImage&&(mutedVideo&&currentImage.onUnmute?currentImage.onUnmute():currentImage.onMute&&currentImage.onMute()),setMutedVideo(!mutedVideo)};(0,react.useEffect)(function(){toggleFullScreenButton.current&&toggleFullScreenButton.current.focus()},[fullScreen]);var canDownload=null===(_currentImage$canDown=null==currentImage?void 0:currentImage.canDownload)||void 0===_currentImage$canDown||_currentImage$canDown,filename=(null==currentImage?void 0:currentImage.name)||"",description=singleSlide||!images.length?"":"".concat(currentSlideIndex+1," из ").concat(images.length),showFullScreenButton=!isSmallImage(meta)&&!(null!=meta&&meta.broken),showDownloadButton=!(null!=meta&&meta.broken)&&canDownload;return(0,jsx_runtime.jsxs)("div",{className:header_index_module.header,children:[(0,jsx_runtime.jsx)(HeaderInfoBlock,{filename:filename,description:description}),(0,jsx_runtime.jsxs)("div",{className:header_index_module.buttons,children:[isVideo(null==currentImage?void 0:currentImage.src)&&(mutedVideo?(0,jsx_runtime.jsx)(UnmuteVideo,{onClick:onMuteButtonClick,dataTestId:constants.D.UNMUTE_BUTTON}):(0,jsx_runtime.jsx)(MuteVideo,{onClick:onMuteButtonClick,dataTestId:constants.D.MUTE_BUTTON})),showFullScreenButton&&(fullScreen?(0,jsx_runtime.jsx)(ExitFullscreen,{onClick:function(){setFullScreen(!1)},buttonRef:toggleFullScreenButton,dataTestId:constants.D.EXIT_FULLSCREEN_BUTTON}):(0,jsx_runtime.jsx)(Fullscreen,{onClick:function(){setFullScreen(!0)},buttonRef:toggleFullScreenButton,dataTestId:constants.D.FULLSCREEN_BUTTON})),showDownloadButton&&(0,jsx_runtime.jsx)(Download,{href:null==currentImage?void 0:currentImage.src,download:null==currentImage?void 0:currentImage.name,dataTestId:constants.D.DOWNLOAD_BUTTON}),(0,jsx_runtime.jsx)(Exit,{onClick:onClose,dataTestId:constants.D.CLOSE_BUTTON})]})]})};try{Header.displayName="Header",Header.__docgenInfo={description:"",displayName:"Header",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/header/Component.tsx#Header"]={docgenInfo:Header.__docgenInfo,name:"Header",path:"packages/gallery/src/components/header/Component.tsx#Header"})}catch(__react_docgen_typescript_loader_error){}var regeneratorRuntime=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),asyncToGenerator=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),HeaderMobile=function(){var _ref,_currentImage$canDown,_useContext=(0,react.useContext)(GalleryContext),onClose=_useContext.onClose,images=_useContext.images,currentSlideIndex=_useContext.currentSlideIndex,getCurrentImage=_useContext.getCurrentImage,getCurrentImageMeta=_useContext.getCurrentImageMeta,hideNavigation=_useContext.hideNavigation,currentImage=getCurrentImage(),meta=getCurrentImageMeta(),description=images.length>1&&"".concat(currentSlideIndex+1," из ").concat(images.length),canDownload=null===(_currentImage$canDown=null==currentImage?void 0:currentImage.canDownload)||void 0===_currentImage$canDown||_currentImage$canDown,showDownloadButton=!(null!=meta&&meta.broken)&&canDownload,handleShareClick=(_ref=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark(function _callee(){var _currentImage$name,title,image,blob,shareData;return(0,regeneratorRuntime.Z)().wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(currentImage){_context.next=2;break}return _context.abrupt("return");case 2:return title=null!==(_currentImage$name=currentImage.name)&&void 0!==_currentImage$name?_currentImage$name:new Date().toISOString().split("T")[0],_context.next=5,fetch(currentImage.src);case 5:return image=_context.sent,_context.next=8,image.blob();case 8:if(blob=_context.sent,shareData={files:[new File([blob],title,{type:blob.type,lastModified:new Date().getTime()})]},!(navigator.canShare(shareData)&&!isVideo(currentImage.src))){_context.next=16;break}return _context.next=14,navigator.share(shareData);case 14:_context.next=18;break;case 16:return _context.next=18,navigator.share({url:currentImage.src,title:title});case 18:case"end":return _context.stop()}},_callee)})),function handleShareClick(){return _ref.apply(this,arguments)});return(0,jsx_runtime.jsxs)("div",{className:classnames_default()("headerMobile_CAfeo",(0,defineProperty.Z)((0,defineProperty.Z)({},"video_muovE",isVideo(null==currentImage?void 0:currentImage.src)),"hide_i3BR8",hideNavigation)),children:[(0,jsx_runtime.jsx)(BackArrow,{onClick:onClose}),(0,jsx_runtime.jsx)(typography_modern.Text,{className:"description_UqAfR",tag:"div",view:"component-primary",color:"static-primary-light",children:description}),(0,jsx_runtime.jsxs)("div",{className:"rightButtons_m0zC4",children:[showDownloadButton&&(0,jsx_runtime.jsx)(Download,{href:null==currentImage?void 0:currentImage.src,download:null==currentImage?void 0:currentImage.name,dataTestId:constants.D.DOWNLOAD_BUTTON}),!(null!=meta&&meta.broken)&&(0,jsx_runtime.jsx)(Share,{onClick:handleShareClick})]})]})},core_class=__webpack_require__("./node_modules/swiper/esm/components/core/core-class.js"),effect_fade=__webpack_require__("./node_modules/swiper/esm/components/effect-fade/effect-fade.js"),a11y=__webpack_require__("./node_modules/swiper/esm/components/a11y/a11y.js"),controller=__webpack_require__("./node_modules/swiper/esm/components/controller/controller.js"),react_swiper=__webpack_require__("./node_modules/swiper/esm/react/swiper.js"),swiper_slide=__webpack_require__("./node_modules/swiper/esm/react/swiper-slide.js"),hook=__webpack_require__("./node_modules/@alfalab/hooks/dist/esm/useFocus/hook.js"),ChevronBackHeavyMIcon=__webpack_require__("./node_modules/@alfalab/icons-glyph/ChevronBackHeavyMIcon.js"),ChevronForwardHeavyMIcon=__webpack_require__("./node_modules/@alfalab/icons-glyph/ChevronForwardHeavyMIcon.js");__webpack_require__("./node_modules/swiper/swiper.min.css"),core_class.Z.use([effect_fade.Z,a11y.Z,controller.Z]);var ImageViewer=function(){var _useContext=(0,react.useContext)(GalleryContext),images=_useContext.images,imagesMeta=_useContext.imagesMeta,fullScreen=_useContext.fullScreen,currentSlideIndex=_useContext.currentSlideIndex,initialSlide=_useContext.initialSlide,setCurrentSlideIndex=_useContext.setCurrentSlideIndex,getSwiper=_useContext.getSwiper,setSwiper=_useContext.setSwiper,slidePrev=_useContext.slidePrev,slideNext=_useContext.slideNext,getCurrentImage=_useContext.getCurrentImage,_useHandleImageViewer=useHandleImageViewer(),handleWrapperClick=_useHandleImageViewer.handleWrapperClick,isMobile=_useHandleImageViewer.isMobile,rightArrowRef=_useHandleImageViewer.rightArrowRef,leftArrowRef=_useHandleImageViewer.leftArrowRef,_useFocus=(0,hook.K)(leftArrowRef,"keyboard"),leftArrowFocused=(0,slicedToArray.Z)(_useFocus,1)[0],_useFocus3=(0,hook.K)(rightArrowRef,"keyboard"),rightArrowFocused=(0,slicedToArray.Z)(_useFocus3,1)[0],swiper=getSwiper(),currentImage=getCurrentImage(),handleSlideChange=(0,react.useCallback)(function(){var _swiper$activeIndex;null==setCurrentSlideIndex||setCurrentSlideIndex(null!==(_swiper$activeIndex=null==swiper?void 0:swiper.activeIndex)&&void 0!==_swiper$activeIndex?_swiper$activeIndex:initialSlide)},[setCurrentSlideIndex,swiper,initialSlide]),swiperProps=(0,react.useMemo)(function(){return{slidesPerView:1,effect:"slide",className:classnames_default()(image_viewer_index_module.swiper,(0,defineProperty.Z)((0,defineProperty.Z)((0,defineProperty.Z)((0,defineProperty.Z)({},image_viewer_index_module.hidden,fullScreen&&!isVideo(null==currentImage?void 0:currentImage.src)),image_viewer_index_module.fullScreenVideo,fullScreen&&isVideo(null==currentImage?void 0:currentImage.src)),image_viewer_index_module.mobile,isMobile),image_viewer_index_module.mobileVideo,isMobile&&isVideo(null==currentImage?void 0:currentImage.src))),controller:{control:swiper},a11y:{slideRole:"img"},initialSlide:initialSlide,simulateTouch:!1,zoom:{maxRatio:4,minRatio:1,toggle:!0},onSwiper:setSwiper,onSlideChange:handleSlideChange,lazy:{loadPrevNext:!0}}},[fullScreen,null==currentImage?void 0:currentImage.src,isMobile,swiper,initialSlide,setSwiper,handleSlideChange]),showControls=!fullScreen&&!isMobile&&!!images.length,swiperWidth=(null==swiper?void 0:swiper.width)||1,swiperHeight=(null==swiper?void 0:swiper.height)||(null==swiper?void 0:swiper.width)||1,swiperAspectRatio=swiperWidth/swiperHeight;return(0,jsx_runtime.jsxs)("div",{className:classnames_default()(image_viewer_index_module.component,(0,defineProperty.Z)((0,defineProperty.Z)({},image_viewer_index_module.mobile,isMobile),image_viewer_index_module.mobileVideo,isMobile&&isVideo(null==currentImage?void 0:currentImage.src))),onClick:handleWrapperClick,children:[showControls&&(0,jsx_runtime.jsx)("div",{className:classnames_default()(image_viewer_index_module.arrow,(0,defineProperty.Z)({},image_viewer_index_module.focused,leftArrowFocused)),onClick:function(){slidePrev()},role:"button",onKeyDown:function(event){"Enter"===event.key&&slidePrev()},tabIndex:0,ref:leftArrowRef,"aria-label":"Предыдущее изображение","data-test-id":constants.D.PREV_SLIDE_BUTTON,children:(0,jsx_runtime.jsx)(ChevronBackHeavyMIcon.ChevronBackHeavyMIcon,{})}),fullScreen&&!isVideo(null==currentImage?void 0:currentImage.src)&&(0,jsx_runtime.jsx)("img",{src:null==currentImage?void 0:currentImage.src,alt:currentImage?getImageAlt(currentImage,currentSlideIndex):"",className:image_viewer_index_module.fullScreenImage}),(0,jsx_runtime.jsx)(react_swiper.t,(0,objectSpread2.Z)((0,objectSpread2.Z)({},swiperProps),{},{children:images.map(function(image,index){var meta=imagesMeta[index],imageAspectRatio=((null==meta?void 0:meta.width)||1)/((null==meta?void 0:meta.height)||1),slideVisible=index===currentSlideIndex;return(0,jsx_runtime.jsx)(swiper_slide.o,{style:{pointerEvents:slideVisible?"auto":"none",transitionProperty:"opacity"},children:function children(_ref){var isActive=_ref.isActive;return(0,jsx_runtime.jsx)(Slide,{isActive:isActive,containerAspectRatio:swiperAspectRatio,image:image,containerHeight:swiperHeight,meta:meta,index:index,imageAspectRatio:imageAspectRatio,slideVisible:slideVisible})}},getImageKey(image,index))})})),showControls&&(0,jsx_runtime.jsx)("div",{className:classnames_default()(image_viewer_index_module.arrow,(0,defineProperty.Z)({},image_viewer_index_module.focused,rightArrowFocused)),onClick:function(){slideNext()},role:"button",onKeyDown:function(event){"Enter"===event.key&&slideNext()},tabIndex:0,ref:rightArrowRef,"aria-label":"Следующее изображение","data-test-id":constants.D.NEXT_SLIDE_BUTTON,children:(0,jsx_runtime.jsx)(ChevronForwardHeavyMIcon.ChevronForwardHeavyMIcon,{})})]})};try{ImageViewer.displayName="ImageViewer",ImageViewer.__docgenInfo={description:"",displayName:"ImageViewer",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/image-viewer/component.tsx#ImageViewer"]={docgenInfo:ImageViewer.__docgenInfo,name:"ImageViewer",path:"packages/gallery/src/components/image-viewer/component.tsx#ImageViewer"})}catch(__react_docgen_typescript_loader_error){}var throttle=__webpack_require__("./node_modules/lodash/throttle.js"),throttle_default=__webpack_require__.n(throttle),paths_NoImagePaths={baseImage:"M 30.5 6.5 L 4 6.5 C 2.894531 6.5 2 7.394531 2 8.5 L 2 31.5 C 2 32.605469 2.894531 33.5 4 33.5 L 36 33.5 C 37.105469 33.5 38 32.605469 38 31.5 L 38 14 L 32.367188 14 C 31.335938 14 30.5 13.164062 30.5 12.132812 Z M 11.917969 15.667969 C 12.285156 15.296875 12.882812 15.296875 13.25 15.667969 L 14.25 16.667969 L 15.25 15.667969 C 15.617188 15.296875 16.214844 15.296875 16.582031 15.667969 C 16.953125 16.035156 16.953125 16.632812 16.582031 17 L 15.582031 18 L 16.582031 19 C 16.953125 19.367188 16.953125 19.964844 16.582031 20.332031 C 16.214844 20.703125 15.617188 20.703125 15.25 20.332031 L 14.25 19.332031 L 13.25 20.332031 C 12.882812 20.703125 12.285156 20.703125 11.917969 20.332031 C 11.546875 19.964844 11.546875 19.367188 11.917969 19 L 12.917969 18 L 11.917969 17 C 11.546875 16.632812 11.546875 16.035156 11.917969 15.667969 Z M 24.75 15.667969 C 24.382812 15.296875 23.785156 15.296875 23.414062 15.667969 C 23.046875 16.035156 23.046875 16.632812 23.414062 17 L 24.414062 18 L 23.414062 19 C 23.046875 19.367188 23.046875 19.964844 23.414062 20.332031 C 23.785156 20.703125 24.378906 20.703125 24.75 20.332031 L 25.75 19.332031 L 26.75 20.332031 C 27.117188 20.703125 27.714844 20.703125 28.082031 20.332031 C 28.449219 19.964844 28.449219 19.367188 28.082031 19 L 27.082031 18 L 28.082031 17 C 28.449219 16.632812 28.449219 16.035156 28.082031 15.667969 C 27.714844 15.296875 27.117188 15.296875 26.75 15.667969 L 25.75 16.667969 Z M 14.40625 27.914062 L 14.402344 27.914062 C 13.898438 28.136719 13.308594 27.910156 13.085938 27.40625 C 12.863281 26.902344 13.089844 26.308594 13.59375 26.085938 L 14 27 C 13.59375 26.085938 13.59375 26.085938 13.59375 26.085938 L 13.597656 26.085938 L 13.601562 26.082031 L 13.609375 26.078125 L 13.621094 26.074219 L 13.636719 26.066406 C 13.660156 26.058594 13.695312 26.042969 13.734375 26.027344 C 13.816406 25.996094 13.933594 25.949219 14.082031 25.898438 C 14.378906 25.796875 14.808594 25.660156 15.359375 25.527344 C 16.457031 25.261719 18.035156 25 20 25 C 21.964844 25 23.542969 25.261719 24.640625 25.527344 C 25.191406 25.660156 25.621094 25.796875 25.917969 25.898438 C 25.96875 25.917969 26.015625 25.933594 26.058594 25.949219 C 26.144531 25.980469 26.210938 26.007812 26.265625 26.027344 C 26.285156 26.035156 26.304688 26.042969 26.320312 26.050781 C 26.335938 26.054688 26.351562 26.0625 26.363281 26.066406 L 26.382812 26.078125 L 26.390625 26.078125 L 26.398438 26.082031 L 26.402344 26.085938 L 26.40625 26.085938 C 26.40625 26.085938 26.40625 26.085938 26.402344 26.089844 L 26.398438 26.105469 L 26.40625 26.085938 C 26.910156 26.308594 27.136719 26.902344 26.914062 27.40625 C 26.691406 27.910156 26.101562 28.136719 25.597656 27.914062 L 20.449219 27.914062 L 25.59375 27.914062 L 25.585938 27.910156 C 25.574219 27.90625 25.554688 27.898438 25.527344 27.886719 C 25.472656 27.863281 25.382812 27.832031 25.261719 27.789062 C 25.019531 27.703125 24.652344 27.589844 24.171875 27.472656 C 23.207031 27.238281 21.785156 27 20 27 C 18.214844 27 16.792969 27.238281 15.828125 27.472656 C 15.347656 27.589844 14.980469 27.703125 14.738281 27.789062 C 14.617188 27.832031 14.527344 27.863281 14.472656 27.886719 C 14.445312 27.898438 14.425781 27.90625 14.414062 27.910156 L 14.40625 27.914062 L 20.449219 27.914062 Z M 14.40625 27.914062",triangleImage:"M 38 12 L 32.5 12 L 32.5 6.5 Z M 38 12",mobileImage:"M19 0H1.33333C0.596954 0 0 0.596944 0 1.33333V16.6667C0 17.4031 0.596954 18 1.33333 18H22.6667C23.403 18 24 17.4031 24 16.6667V4.99995H20.2444C19.5571 4.99995 19 4.44279 19 3.7555V0ZM6.61123 6.11112C6.85668 5.86566 7.25465 5.86566 7.5001 6.11112L8.1667 6.77773L8.83331 6.1111C9.07878 5.86564 9.47675 5.86564 9.7222 6.1111C9.96766 6.35657 9.96766 6.75454 9.7222 7L9.05558 7.66661L9.72231 8.33333C9.96777 8.57878 9.96777 8.97675 9.72231 9.22221C9.47686 9.46767 9.07889 9.46767 8.83344 9.22221L8.16671 8.55548L7.49999 9.22221C7.25454 9.46765 6.85657 9.46765 6.6111 9.22221C6.36565 8.97675 6.36565 8.57878 6.6111 8.33331L7.27782 7.66659L6.61123 7C6.36576 6.75454 6.36576 6.35657 6.61123 6.11112ZM15.1661 6.11112C14.9207 5.86566 14.5227 5.86566 14.2772 6.11112C14.0318 6.35659 14.0318 6.75456 14.2772 7L14.9438 7.66661L14.2771 8.33333C14.0317 8.57878 14.0317 8.97675 14.2771 9.22221C14.5226 9.46767 14.9206 9.46767 15.166 9.22221L15.8327 8.55548L16.4995 9.22221C16.7449 9.46767 17.1429 9.46767 17.3883 9.22221C17.6338 8.97677 17.6338 8.5788 17.3883 8.33333L16.7216 7.66661L17.3882 7C17.6337 6.75454 17.6337 6.35657 17.3882 6.11112C17.1428 5.86566 16.7448 5.86566 16.4993 6.11112L15.8327 6.77773L15.1661 6.11112ZM8.26956 14.2764L8.26919 14.2766C7.93322 14.4248 7.54007 14.2733 7.39079 13.9374C7.24125 13.601 7.39278 13.207 7.72924 13.0575L8 13.6667C7.72924 13.0575 7.72962 13.0573 7.72962 13.0573L7.73005 13.0571L7.73099 13.0567L7.7333 13.0557L7.73957 13.0529L7.74749 13.0495L7.75875 13.0448C7.77446 13.0381 7.796 13.0293 7.82326 13.0184C7.87777 12.9968 7.95515 12.9674 8.05442 12.9328C8.25294 12.8638 8.53925 12.7742 8.90544 12.6854C9.63773 12.5079 10.6907 12.3333 12 12.3333C13.3093 12.3333 14.3623 12.5079 15.0946 12.6854C15.4608 12.7742 15.7471 12.8638 15.9456 12.9328C15.9796 12.9447 16.011 12.9559 16.0398 12.9664C16.0952 12.9866 16.1409 13.0042 16.1767 13.0184C16.1901 13.0238 16.2022 13.0286 16.2128 13.033C16.2238 13.0375 16.2333 13.0414 16.2413 13.0448L16.2559 13.051L16.2604 13.0529L16.2667 13.0557L16.269 13.0567L16.27 13.0571L16.2704 13.0573C16.2704 13.0573 16.2704 13.0573 16.2692 13.0602L16.2646 13.0707L16.2708 13.0575C16.6072 13.207 16.7587 13.601 16.6092 13.9374C16.4599 14.2733 16.0671 14.4249 15.731 14.2767L15.7304 14.2764L12.2987 14.2764L15.73 14.2762L15.7238 14.2736C15.7163 14.2704 15.7032 14.265 15.6846 14.2576C15.6473 14.2428 15.588 14.2201 15.5075 14.1922C15.3467 14.1362 15.1017 14.0591 14.7804 13.9812C14.1377 13.8254 13.1907 13.6667 12 13.6667C10.8093 13.6667 9.86227 13.8254 9.21956 13.9812C8.89825 14.0591 8.65331 14.1362 8.49245 14.1922C8.41204 14.2201 8.3527 14.2428 8.31541 14.2576C8.29677 14.265 8.28365 14.2704 8.27616 14.2736L8.27041 14.276L12.2987 14.2764L8.26956 14.2764Z",mobileTriangle:"M23.9999 3.66661H20.3333V0L23.9999 3.66661Z"},image_preview_index_module={component:"component_mtvxt",image:"image_JMHXU",mobile:"mobile_BWLTU",active:"active_iRVjC",preview:"preview_W5avX",loading:"loading_k_GI3",brokenImageWrapper:"brokenImageWrapper_Y58V3",brokenIcon:"brokenIcon_ZF1vD",focused:"focused_c0moA",canvasPreview:"canvasPreview_Q0k3H"},ImagePreview=function(_ref){var image=_ref.image,_ref$active=_ref.active,active=void 0!==_ref$active&&_ref$active,index=_ref.index,onSelect=_ref.onSelect,className=_ref.className,_useContext=(0,react.useContext)(GalleryContext),imagesMeta=_useContext.imagesMeta,isMobile="mobile"===_useContext.view,previewWidth=isMobile?46:56,previewHeight=isMobile?46:56,ref=(0,react.useRef)(null),canvasRef=(0,react.useRef)(null);(0,react.useEffect)(function(){var _imagesMeta$index,_imagesMeta$index$pla,canvas=canvasRef.current,video=null===(_imagesMeta$index=imagesMeta[index])||void 0===_imagesMeta$index?void 0:null===(_imagesMeta$index$pla=_imagesMeta$index.player)||void 0===_imagesMeta$index$pla?void 0:_imagesMeta$index$pla.current,context=null==canvas?void 0:canvas.getContext("2d"),drawPreview=function(){video&&(null==context||context.drawImage(video,0,0,video.videoWidth/12,video.videoHeight/12))};return drawPreview(),isVideo(image.src)&&(null==video||video.addEventListener("canplay",drawPreview)),function(){isVideo(image.src)&&(null==video||video.removeEventListener("canplay",drawPreview))}},[image.src,imagesMeta,index]);var _useFocus=(0,hook.K)(ref,"keyboard"),focused=(0,slicedToArray.Z)(_useFocus,1)[0],meta=imagesMeta[index],isBroken=!!(null==meta?void 0:meta.broken);return(0,jsx_runtime.jsx)("div",{className:classnames_default()(image_preview_index_module.component,(0,defineProperty.Z)((0,defineProperty.Z)((0,defineProperty.Z)({},image_preview_index_module.active,active),image_preview_index_module.focused,focused),image_preview_index_module.mobile,isMobile),className),onClick:function(){onSelect(index)},role:"button",onKeyDown:function(event){"Enter"===event.key&&onSelect(index)},onMouseDown:function(e){e.preventDefault()},tabIndex:0,ref:ref,"aria-label":"Перейти к ".concat(index+1," элементу"),children:isBroken?(0,jsx_runtime.jsx)("div",{className:classnames_default()(image_preview_index_module.preview,(0,defineProperty.Z)((0,defineProperty.Z)({},image_preview_index_module.mobile,isMobile),image_preview_index_module.active,active),image_preview_index_module.brokenImageWrapper),children:(0,jsx_runtime.jsx)("div",{className:classnames_default()(image_preview_index_module.brokenIcon),children:(0,jsx_runtime.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:previewWidth,height:previewHeight,viewBox:"".concat(isMobile?-6:0," ").concat(isMobile?-12:0," ").concat(previewWidth," ").concat(previewHeight),fill:"none",children:[(0,jsx_runtime.jsx)("rect",{fill:"none"}),(0,jsx_runtime.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:isMobile?paths_NoImagePaths.mobileImage:paths_NoImagePaths.baseImage,fill:"#89898A"}),(0,jsx_runtime.jsx)("path",{d:isMobile?paths_NoImagePaths.mobileTriangle:paths_NoImagePaths.triangleImage,fill:"#89898A"})]})})}):image.previewSrc?(0,jsx_runtime.jsx)("div",{className:classnames_default()(image_preview_index_module.preview,image_preview_index_module.image,(0,defineProperty.Z)((0,defineProperty.Z)({},image_preview_index_module.loading,!meta),image_preview_index_module.mobile,isMobile)),children:(0,jsx_runtime.jsx)("img",{src:image.previewSrc,alt:getImageAlt(image,index)})}):isVideo(image.src)?(0,jsx_runtime.jsx)("div",{className:classnames_default()(image_preview_index_module.preview,image_preview_index_module.image,(0,defineProperty.Z)((0,defineProperty.Z)({},image_preview_index_module.loading,!meta),image_preview_index_module.mobile,isMobile)),children:(0,jsx_runtime.jsx)("canvas",{className:classnames_default()(image_preview_index_module.canvasPreview,(0,defineProperty.Z)({},image_preview_index_module.mobile,isMobile)),"data-testid":"canvas",width:previewWidth,height:previewHeight,ref:canvasRef})}):(0,jsx_runtime.jsx)("div",{className:classnames_default()(image_preview_index_module.preview,image_preview_index_module.image,(0,defineProperty.Z)((0,defineProperty.Z)({},image_preview_index_module.loading,!meta),image_preview_index_module.mobile,isMobile)),children:(0,jsx_runtime.jsx)("img",{src:image.src,alt:getImageAlt(image,index)})})})};try{ImagePreview.displayName="ImagePreview",ImagePreview.__docgenInfo={description:"",displayName:"ImagePreview",props:{image:{defaultValue:null,description:"",name:"image",required:!0,type:{name:"GalleryImage"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},active:{defaultValue:{value:"false"},description:"",name:"active",required:!1,type:{name:"boolean"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(index: number) => void"}},className:{defaultValue:null,description:"",name:"className",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/image-preview/Component.tsx#ImagePreview"]={docgenInfo:ImagePreview.__docgenInfo,name:"ImagePreview",path:"packages/gallery/src/components/image-preview/Component.tsx#ImagePreview"})}catch(__react_docgen_typescript_loader_error){}var navigation_bar_index_module={component:"component_Q3fhU",mobile:"mobile_U2wDi",preview:"preview_KzyqM"},NavigationBar=function(){var containerRef=(0,react.useRef)(null),_useState=(0,react.useState)(!1),_useState2=(0,slicedToArray.Z)(_useState,2),isNavMouseDowned=_useState2[0],setIsNavMouseDowned=_useState2[1],_useContext=(0,react.useContext)(GalleryContext),images=_useContext.images,currentSlideIndex=_useContext.currentSlideIndex,setCurrentSlideIndex=_useContext.setCurrentSlideIndex,getSwiper=_useContext.getSwiper,setPlayingVideo=_useContext.setPlayingVideo,view=_useContext.view,swiper=getSwiper(),handlePreviewSelect=function(index){null==setCurrentSlideIndex||setCurrentSlideIndex(index),swiper&&(setPlayingVideo(!0),swiper.slideTo(index))},scroll=(0,react.useCallback)(function(scrollValue){containerRef.current&&containerRef.current.scroll({top:0,left:containerRef.current.scrollLeft+scrollValue,behavior:"smooth"})},[]),handleMouseNavigationMove=throttle_default()(function(e){if(containerRef.current&&isNavMouseDowned){var container=containerRef.current,_container$getBoundin=container.getBoundingClientRect(),containerWidth=_container$getBoundin.width,containerLeft=_container$getBoundin.left,mouseX=e.clientX;mouseX>containerWidth+containerLeft-150?container.scrollBy({left:(mouseX-(containerWidth+containerLeft-150))*2,behavior:"smooth"}):mouseX<containerLeft+150&&container.scrollBy({left:(mouseX-(containerLeft+150))*2,behavior:"smooth"})}},150),handlePreviewPosition=(0,react.useCallback)(function(preview,containerWidth){var _preview$getBoundingC=preview.getBoundingClientRect(),right=_preview$getBoundingC.right,left=_preview$getBoundingC.left,x=_preview$getBoundingC.x;"mobile"===view&&scroll(x-containerWidth/2+24),right>containerWidth?scroll(right-containerWidth+24):left<0&&scroll(left-24)},[scroll,view]);return(0,react.useEffect)(function(){if(containerRef.current){var containerWidth=containerRef.current.getBoundingClientRect().width,activePreview=containerRef.current.children[currentSlideIndex];activePreview&&handlePreviewPosition(activePreview,containerWidth)}},[currentSlideIndex,handlePreviewPosition,scroll]),(0,jsx_runtime.jsx)("div",{className:classnames_default()(navigation_bar_index_module.component,(0,defineProperty.Z)({},navigation_bar_index_module.mobile,"mobile"===view)),ref:containerRef,"data-test-id":constants.D.NAVIGATION_BAR,onMouseDown:function(){setIsNavMouseDowned(!0)},onMouseUp:function(){setIsNavMouseDowned(!1),containerRef.current&&(containerRef.current.style.scrollBehavior="auto")},onMouseMove:handleMouseNavigationMove,children:images.map(function(image,index){var active=index===currentSlideIndex;return(0,jsx_runtime.jsx)(ImagePreview,{image:image,active:active,index:index,onSelect:handlePreviewSelect,className:classnames_default()(navigation_bar_index_module.preview,(0,defineProperty.Z)({},navigation_bar_index_module.mobile,"mobile"===view))},getImageKey(image,index))})})};try{NavigationBar.displayName="NavigationBar",NavigationBar.__docgenInfo={description:"",displayName:"NavigationBar",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/components/navigation-bar/Component.tsx#NavigationBar"]={docgenInfo:NavigationBar.__docgenInfo,name:"NavigationBar",path:"packages/gallery/src/components/navigation-bar/Component.tsx#NavigationBar"})}catch(__react_docgen_typescript_loader_error){}var info_bar_index_module={description:"description_lDblQ",infoWrapper:"infoWrapper_Yi45a",video:"video_Vmojo"},InfoBar=function(){var _useContext=(0,react.useContext)(GalleryContext),getCurrentImage=_useContext.getCurrentImage,mutedVideo=_useContext.mutedVideo,setMutedVideo=_useContext.setMutedVideo,playingVideo=_useContext.playingVideo,setPlayingVideo=_useContext.setPlayingVideo,image=getCurrentImage(),handleMuteVideo=(0,react.useCallback)(function(){image&&(mutedVideo&&image.onUnmute?image.onUnmute():image.onMute&&image.onMute()),setMutedVideo(!mutedVideo)},[image,mutedVideo,setMutedVideo]),handlePlayVideo=(0,react.useCallback)(function(){setPlayingVideo(!playingVideo)},[playingVideo,setPlayingVideo]);return isVideo(null==image?void 0:image.src)?(0,jsx_runtime.jsxs)("section",{className:classnames_default()(info_bar_index_module.infoWrapper,info_bar_index_module.video),children:[playingVideo?(0,jsx_runtime.jsx)(Pause,{onClick:handlePlayVideo}):(0,jsx_runtime.jsx)(Play,{onClick:handlePlayVideo}),(0,jsx_runtime.jsx)(typography_modern.Text,{className:info_bar_index_module.description,tag:"div",view:"component",color:"static-primary-light",children:null==image?void 0:image.name}),mutedVideo?(0,jsx_runtime.jsx)(UnmuteVideo,{onClick:handleMuteVideo}):(0,jsx_runtime.jsx)(MuteVideo,{onClick:handleMuteVideo})]}):(0,jsx_runtime.jsx)("section",{className:info_bar_index_module.infoWrapper,children:(0,jsx_runtime.jsx)(typography_modern.Text,{className:info_bar_index_module.description,tag:"div",view:"component",color:"static-primary-light",children:null==image?void 0:image.name})})},src_index_module={container:"container_yK_bc",mobile:"mobile_NE0Cn",modal:"modal_qWkLv",navigationVideo:"navigationVideo_b86py",hide:"hide_ssFd6",hideInfo:"hideInfo_j1rfK",bottomButton:"bottomButton_zbwCo"},Backdrop=function(){return null},Gallery=function(_ref){var _imagesMeta$currentSl,_imagesMeta$currentSl2,_images$currentSlideI,open=_ref.open,images=_ref.images,slideIndex=_ref.slideIndex,_ref$initialSlide=_ref.initialSlide,initialSlide=void 0===_ref$initialSlide?0:_ref$initialSlide,_ref$loop=_ref.loop,loop=void 0===_ref$loop||_ref$loop,onClose=_ref.onClose,onSlideIndexChange=_ref.onSlideIndexChange,popupClassName=_ref.popupClassName,currentSlideIndexState=(0,react.useState)(initialSlide),uncontrolled=void 0===slideIndex,_ref2=uncontrolled?currentSlideIndexState:[slideIndex,onSlideIndexChange],_ref3=(0,slicedToArray.Z)(_ref2,2),currentSlideIndex=_ref3[0],setCurrentSlideIndex=_ref3[1],_useState=(0,react.useState)(),_useState2=(0,slicedToArray.Z)(_useState,2),swiper=_useState2[0],setSwiper=_useState2[1],_useState3=(0,react.useState)([]),_useState4=(0,slicedToArray.Z)(_useState3,2),imagesMeta=_useState4[0],setImagesMeta=_useState4[1],_useState5=(0,react.useState)(!1),_useState6=(0,slicedToArray.Z)(_useState5,2),fullScreen=_useState6[0],setFullScreen=_useState6[1],_useState7=(0,react.useState)(!0),_useState8=(0,slicedToArray.Z)(_useState7,2),mutedVideo=_useState8[0],setMutedVideo=_useState8[1],_useState9=(0,react.useState)(!0),_useState0=(0,slicedToArray.Z)(_useState9,2),playingVideo=_useState0[0],setPlayingVideo=_useState0[1],_useState1=(0,react.useState)(!1),_useState10=(0,slicedToArray.Z)(_useState1,2),hideNavigation=_useState10[0],setHideNavigation=_useState10[1],isDesktop=(0,mq_modern.useIsDesktop)(),isCurrentVideo=!!(null!==(_imagesMeta$currentSl=imagesMeta[currentSlideIndex])&&void 0!==_imagesMeta$currentSl&&null!==(_imagesMeta$currentSl2=_imagesMeta$currentSl.player)&&void 0!==_imagesMeta$currentSl2&&_imagesMeta$currentSl2.current),bottomButton=null===(_images$currentSlideI=images[currentSlideIndex])||void 0===_images$currentSlideI?void 0:_images$currentSlideI.bottomButton,slideTo=(0,react.useCallback)(function(index){images[index]&&(null==setCurrentSlideIndex||setCurrentSlideIndex(index),swiper&&(setPlayingVideo(!0),swiper.slideTo(index)))},[images,setCurrentSlideIndex,swiper]),slideNext=(0,react.useCallback)(function(){var lastIndex=images.length-1,nextIndex=currentSlideIndex+1;nextIndex>=images.length&&(nextIndex=loop?0:lastIndex),slideTo(nextIndex)},[images.length,loop,currentSlideIndex,slideTo]),slidePrev=(0,react.useCallback)(function(){var lastIndex=images.length-1,nextIndex=currentSlideIndex-1;nextIndex<0&&(nextIndex=loop?lastIndex:0),slideTo(nextIndex)},[images.length,loop,currentSlideIndex,slideTo]),setImageMeta=(0,react.useCallback)(function(meta,index){imagesMeta[index]=meta,setImagesMeta(imagesMeta.slice())},[imagesMeta]),handleBottomButtonClick=(0,react.useCallback)(function(e){e.stopPropagation(),null!=bottomButton&&bottomButton.onClick&&bottomButton.onClick(e)},[bottomButton]),handleClose=(0,react.useCallback)(function(){onClose(),uncontrolled&&(null==setCurrentSlideIndex||setCurrentSlideIndex(initialSlide)),setFullScreen(!1)},[initialSlide,onClose,setCurrentSlideIndex,uncontrolled]),handleKeyDown=(0,react.useCallback)(function(event){if(open&&!fullScreen)switch(event.key){case"ArrowLeft":slidePrev();break;case"ArrowRight":slideNext()}},[fullScreen,open,slideNext,slidePrev]),onUnmount=(0,react.useCallback)(function(){setPlayingVideo(!0),setMutedVideo(!0)},[setPlayingVideo]);(0,react.useEffect)(function(){uncontrolled||null!=swiper&&swiper.destroyed||null==swiper||swiper.slideTo(currentSlideIndex)},[uncontrolled,currentSlideIndex,swiper]),(0,react.useEffect)(function(){return document.addEventListener("keydown",handleKeyDown),function(){document.removeEventListener("keydown",handleKeyDown)}},[handleKeyDown]),(0,react.useEffect)(function(){var startY,abortController=new AbortController,signal=abortController.signal;return document.addEventListener("touchstart",function(e){startY=e.touches[0].clientY},{signal:signal}),document.addEventListener("touchmove",function(e){var endY=e.changedTouches[0].clientY;startY-endY<-250&&onClose()},{signal:signal}),function(){abortController.abort()}},[onClose]);var singleSlide=1===images.length,showNavigationBar=!singleSlide&&!fullScreen;return(0,jsx_runtime.jsx)(GalleryContext.Provider,{value:{view:isDesktop?"desktop":"mobile",singleSlide:singleSlide,currentSlideIndex:currentSlideIndex,images:images,imagesMeta:imagesMeta,fullScreen:fullScreen,initialSlide:uncontrolled?initialSlide:currentSlideIndex,setFullScreen:setFullScreen,playingVideo:playingVideo,setPlayingVideo:setPlayingVideo,mutedVideo:mutedVideo,setMutedVideo:setMutedVideo,hideNavigation:hideNavigation,setHideNavigation:setHideNavigation,setImageMeta:setImageMeta,slideNext:slideNext,slidePrev:slidePrev,slideTo:slideTo,getSwiper:function getSwiper(){return swiper},setSwiper:setSwiper,onClose:handleClose,setCurrentSlideIndex:setCurrentSlideIndex,getCurrentImage:function getCurrentImage(){return images[currentSlideIndex]},getCurrentImageMeta:function getCurrentImageMeta(){return imagesMeta[currentSlideIndex]}},children:(0,jsx_runtime.jsx)(modern.BaseModal,{open:open,className:classnames_default()(src_index_module.modal,popupClassName),onEscapeKeyDown:function(){fullScreen?setFullScreen(!1):handleClose()},Backdrop:Backdrop,onUnmount:onUnmount,children:(0,jsx_runtime.jsxs)("div",{className:classnames_default()(src_index_module.container,(0,defineProperty.Z)({},src_index_module.mobile,!isDesktop)),children:[isDesktop?(0,jsx_runtime.jsx)(Header,{}):(0,jsx_runtime.jsx)(HeaderMobile,{}),1===images.length?(0,jsx_runtime.jsx)(Single,{}):(0,jsx_runtime.jsx)(ImageViewer,{}),(0,jsx_runtime.jsxs)("nav",{className:classnames_default()((0,defineProperty.Z)((0,defineProperty.Z)((0,defineProperty.Z)({},src_index_module.navigationVideo,isCurrentVideo&&!isDesktop),src_index_module.hide,showNavigationBar&&hideNavigation&&!isDesktop),src_index_module.hideInfo,!showNavigationBar&&hideNavigation&&!isDesktop)),children:[!isDesktop&&(0,jsx_runtime.jsx)(Subtitles,{}),isCurrentVideo&&!isDesktop&&bottomButton&&(0,jsx_runtime.jsx)(BottomButton,{bottomButton:bottomButton,onClick:handleBottomButtonClick,className:src_index_module.bottomButton}),showNavigationBar&&(0,jsx_runtime.jsx)(NavigationBar,{}),!isDesktop&&(0,jsx_runtime.jsx)(InfoBar,{})]})]})})})};try{Gallery.displayName="Gallery",Gallery.__docgenInfo={description:"",displayName:"Gallery",props:{open:{defaultValue:null,description:"Управление видимостью",name:"open",required:!0,type:{name:"boolean"}},images:{defaultValue:null,description:"Массив изображений",name:"images",required:!0,type:{name:"GalleryImage[]"}},loop:{defaultValue:{value:"true"},description:"Зациклить галерею",name:"loop",required:!1,type:{name:"boolean"}},initialSlide:{defaultValue:{value:"0"},description:"Индекс открытого изображение",name:"initialSlide",required:!1,type:{name:"number"}},onClose:{defaultValue:null,description:"Обработчик закрытия",name:"onClose",required:!0,type:{name:"() => void"}},slideIndex:{defaultValue:null,description:"Индекс текущего изображения",name:"slideIndex",required:!1,type:{name:"number"}},onSlideIndexChange:{defaultValue:null,description:"Обработчик изменения текущего изображения",name:"onSlideIndexChange",required:!1,type:{name:"((index: number) => void)"}},popupClassName:{defaultValue:null,description:"Дополнительный класс для попапа",name:"popupClassName",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/gallery/src/Component.tsx#Gallery"]={docgenInfo:Gallery.__docgenInfo,name:"Gallery",path:"packages/gallery/src/Component.tsx#Gallery"})}catch(__react_docgen_typescript_loader_error){}},"./packages/gallery/src/utils/constants.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{D:function(){return TestIds}});var TestIds={ACTIVE_IMAGE:"active-image",PREV_SLIDE_BUTTON:"prev-slide-button",NEXT_SLIDE_BUTTON:"next-slide-button",CLOSE_BUTTON:"close-button",FULLSCREEN_BUTTON:"fullscreen-button",EXIT_FULLSCREEN_BUTTON:"exit-fullscreen-button",DOWNLOAD_BUTTON:"download-button",NAVIGATION_BAR:"navigation-bar",MUTE_BUTTON:"mute-button",UNMUTE_BUTTON:"unmute-button"}}}]);