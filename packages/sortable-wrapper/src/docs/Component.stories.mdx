import { Meta, Story } from '@storybook/addon-docs';
import { select } from '@storybook/addon-knobs';
import { ComponentHeader, Tabs } from 'storybook/blocks';

import { Typography } from '@alfalab/core-components-typography';
import { SortableWrapper } from '@alfalab/core-components-sortable-wrapper';
import { DiamondsMIcon } from '@alfalab/icons-glyph/DiamondsMIcon';
import { GenericWrapper } from '@alfalab/core-components-generic-wrapper';
import { SuperEllipse } from '@alfalab/core-components-icon-view/super-ellipse';
import { Gap } from '@alfalab/core-components-gap';
import { version } from '../../package.json';
import Description from './description.mdx';
import Development from './development.mdx';
import Changelog from '../../CHANGELOG.md';

<Meta title='Components/SortableWrapper' component={SortableWrapper} id='SortableWrapper' />

<!-- Canvas -->

<Story name='SortableWrapper'>
    {React.createElement(() => {
        const [items, setItems] = React.useState(() =>
            [1, 2, 3, 4, 5, 6].map((item) => ({ id: item })),
        );
        const renderItem = (item) => {
            return (
                <GenericWrapper alignItems='center' padding={{ top: 's', bottom: 's', left: 'm' }}>
                    <GenericWrapper>
                        <SuperEllipse size={48}>
                            <DiamondsMIcon aria-label='diamonds' />
                        </SuperEllipse>
                    </GenericWrapper>
                    <Gap size='m' direction='horizontal' />
                    <GenericWrapper>
                        <GenericWrapper column>
                            <Typography.Text view='component'>{`Draggable ${item.id}`}</Typography.Text>
                            <Gap size='2xs' />
                            <Typography.Text view='primary-small' color='secondary'>
                                Перетащи меня
                            </Typography.Text>
                        </GenericWrapper>
                    </GenericWrapper>
                </GenericWrapper>
            );
        };
        const gapSizes = [undefined, '3xs', '2xs', 'xs', 's', 'm', 'l'];
        const paddingTop = select('padding.top', gapSizes, undefined);
        const paddingRight = select('padding.right', gapSizes, undefined);
        const paddingBottom = select('padding.bottom', gapSizes, undefined);
        const paddingLeft = select('padding.left', gapSizes, undefined);
        return (
            <div style={{ maxWidth: 340 }}>
                <SortableWrapper
                    items={items}
                    onDragEnd={(_, newIds) => setItems(newIds)}
                    padding={{
                        top: paddingTop,
                        right: paddingRight,
                        bottom: paddingBottom,
                        left: paddingLeft,
                    }}
                    borderRadius={select('border-radius', [undefined, 'm', 'l', 'xl'], undefined)}
                    renderItem={renderItem}
                    activatorNode={select('activatorNode', ['cell', 'control'], 'cell')}
                    view={select('view', ['primary', 'secondary'], 'primary')}
                />
            </div>
        );
    })}
</Story>

<!-- Docs -->

<ComponentHeader
    name='SortableWrapper'
    version={version}
    package='@alfalab/core-components/sortable-wrapper'
    children='Список перетаскиваемых элементов'
/>

<Tabs description={<Description />} changelog={<Changelog />} development={<Development />} />
