import { Meta } from '@storybook/blocks';

<Meta
    title='For contributors/Чек-лист для Code Review'
    parameters={{ previewTabs: { canvas: { hidden: true } } }}
    id='Instructions/Code-review-checklist'
/>

## Чек-лист для Code Review

Код-ревью часто требует много времени и внимания, и легко что-нибудь упустить.
Мы составили чек-лист со списком того, на что нужно обратить внимание.

#

✅ Проходят ли все авточеки

-   Screenshots
    > Если не проходят тесты, посмотреть в Details причины. В Summary можно скачать архив с не пройденными скриншотами и посмотреть что изменилось. Оставить коммент.
-   Demo build
    > Демка сторибука должна корректно собираться, ссылка на демку должна появиться в ПРе.
-   Lint PR / Validate PR title
    > Соответствие названия ПР и наличия хотя бы одного коммита commitizen/conventional-commit-types
-   Tests & Build / run tests
    > Прохождение unit & snapshot тестов.
-   Tests & Build / build packages
    > Проверка на корректный билд проекта.
-   Css Vars
    > Проверка на наличие несуществующих css custom properties.(Проверка завершится ошибкой, если, например, в index.css используется переменная --color, которая не объявлена в root или объявлена в другом файле, который не импортирован в index.css).

#

✅ Внимательно проанализировать предлагаемые изменения по следующим критериям:

-   Архитектура
    > Разбит ли достаточно код на модули. Можно ли упростить решение, при сохрании функционала.
-   Функциональность
    > Изменения в коде выполняют свою задачу? Нет ли излишнего функционала (YAGNI).
-   Понятность
    > Тяжел ли код для понимания? Решение можно упростить? В сложных местах добавлены комментарии.
-   Написанные тесты. Дополненные тесты к новому функционалу.
    > Покрытие unit-тестами всех пропсов, изменения классов, рендера компонентов, осоновных функций компонента.
    > Написанные скриншот-тесты для всех состояний компонента и тем.
-   Сode style
    > Правильное форматирование кода. Prettier не всегда отрабатывает.

Если есть замечания - оставить комментарии на основе анализа изменений.
Необходимо, чтобы правки реально способствовали улучшению качества кода по какому-либо аспекту.

#

✅ Проверить в собранной Демке корректную работу компонента.

-   Соответствие поставленной задачи.
-   Проверить смежные компоненты использующие измененный компонент.
-   Проверить доступность интерактивных элементов с клавиатуры.

#

✅ При отсутствии замечаний поставить Approve.

#

❗ Неочевидные правила

-   В названиях css классов нельзя использовать `default` - это ломает некоторые сборки в продуктах!
-   При разработке, должно быть предусмотрено использование компонент с ssr.
    > На сервере нет глобального объекта window, это необходимо учитывать при разработке.
-   В `index.module.css` компонента обязательно должен присутствовать `@import '../../themes/src/default.css'`.
    Иначе переменные в сборке не будут работать.
-   При использовании других компонент из библиотеки необходимо следить,
    чтобы импорт начинался с `@alfalab`.
    > При использовании автоимпорта, иногда подставляется импорт из локальной папки `../component/src`.
-   При добавлении сторонней библиотеки в зависимости, необходимо проследить, чтобы она присутствовала в root `package.json` и в `package.json` самого компонента.
-   При обновлении скриншотов необходимо следить, чтобы файлы сохранялись в git lfs.
    > Если при обновлении скриншотов в проекте не был установлен git-lfs, то скриншоты сохранятся в обычное git хранилище.
-   В документации(Component.stories.tsx) компоненты, которые используются в Story, должны быть импортированы из `@alfalab/core-components-x`.
    Это нужно для того, чтобы сторибук в gh-pages собирался из уже собранных rollup-ом компонентов, а не из исходного кода.
    Относительные импорты(`import { ComponentName } from './Component'`) нужно использовать только для отображения свойств компонента(`<ArgsTable of={ComponentName}`>).
